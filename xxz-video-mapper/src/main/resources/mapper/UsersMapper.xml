<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.leicx.xxz.mapper.UsersMapper">
  <resultMap id="BaseResultMap" type="com.leicx.xxz.entity.UserEntity">
    <!--
      WARNING - @mbg.generated
    -->
    <result column="id" jdbcType="INTEGER" property="id" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="age" jdbcType="INTEGER" property="age" />
    <result column="avatar" jdbcType="VARCHAR" property="avatar" />
    <result column="wxid" jdbcType="VARCHAR" property="wxid" />
    <result column="points" jdbcType="BIGINT" property="points" />
    <result column="desc" jdbcType="VARCHAR" property="desc" />
    <result column="status" jdbcType="BIT" property="status" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="del" jdbcType="BIT" property="del" />
  </resultMap>

  <insert id="insert" parameterType="com.leicx.xxz.entity.UserEntity">
    INSERT INTO users (
    name,age,avatar,wxid,points,desc,status,create_time,update_time,del
    ) VALUES (
    #{name},#{age},#{avatar},#{wxid},#{points},#{desc},#{status},#{createTime},#{updateTime},#{del}
    )
    <selectKey keyProperty="id" resultType="Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
  </insert>

  <update id="update" parameterType="com.leicx.xxz.entity.UserEntity">
    UPDATE
    users
    SET
    <if test="id!=null">id = #{id}</if>
    <if test="name!=null">, name = #{name}</if>
    <if test="age!=null">, age = #{age}</if>
    <if test="avatar!=null">, avatar = #{avatar}</if>
    <if test="wxid!=null">, wxid = #{wxid}</if>
    <if test="points!=null">, points = #{points}</if>
    <if test="desc!=null">, desc = #{desc}</if>
    <if test="status!=null">, status = #{status}</if>
    <if test="createTime!=null">, create_time = #{createTime}</if>
    <if test="updateTime!=null">, update_time = #{updateTime}</if>
    <if test="del!=null">, del = #{del}</if>
    <where>
      id = #{id}
    </where>
  </update>
  <select id="listByUserNameLike" resultType="com.leicx.xxz.entity.UserEntity">
    SELECT * FROM
    users
    <where>
      <include refid="paramColumns" />
    </where>
  </select>

  <select id="getUserByName" resultType="com.leicx.xxz.entity.UserEntity">
    SELECT * FROM
    users
    <where>
      name = #{name} AND del = #{del}
    </where>
  </select>

  <sql id="paramColumns">
    1
    <if test="param.nameLike!=null">
      AND name LIKE CONCAT ('%', #{param.nameLike}, '%')
    </if>
    <if test="param.id!=null">
      AND id = #{param.id}
    </if>
    <if test="param.del!=null">
      AND del = #{param.del}
    </if>
    <if test="param.name!=null">
      AND name = #{param.name}
    </if>
  </sql>

</mapper>